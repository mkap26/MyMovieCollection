<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>My Movie Collection</title>
Â  Â  <link rel="preconnect" href="https://fonts.googleapis.com">
Â  Â  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  Â  <script>
Â  Â  Â  Â  // Configure Tailwind to use Inter font
Â  Â  Â  Â  tailwind.config = {
Â  Â  Â  Â  Â  Â  theme: {
Â  Â  Â  Â  Â  Â  Â  Â  extend: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fontFamily: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sans: ['Inter', 'sans-serif'],
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  };
Â  Â  </script>
Â  Â  <style>
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  background-color: #f3f4f6;
Â  Â  Â  Â  Â  Â  font-family: 'Inter', sans-serif;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* Custom scrollbar for a cleaner look */
Â  Â  Â  Â  ::-webkit-scrollbar {
Â  Â  Â  Â  Â  Â  width: 8px;
Â  Â  Â  Â  }
Â  Â  Â  Â  ::-webkit-scrollbar-track {
Â  Â  Â  Â  Â  Â  background: #e5e7eb;
Â  Â  Â  Â  }
Â  Â  Â  Â  ::-webkit-scrollbar-thumb {
Â  Â  Â  Â  Â  Â  background: #9ca3af;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  }
Â  Â  Â  Â  ::-webkit-scrollbar-thumb:hover {
Â  Â  Â  Â  Â  Â  background: #6b7280;
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  /* CSS for the flip animation */
Â  Â  Â  Â  .movie-card-container {
Â  Â  Â  Â  Â  Â  perspective: 1000px;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  }
Â  Â  Â  Â  .movie-card {
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  transition: transform 0.6s;
Â  Â  Â  Â  Â  Â  transform-style: preserve-3d;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* The core fix: use transform scale and a higher z-index on the container's pseudo-element. */
Â  Â  Â  Â  .movie-card-container:focus-within .movie-card,
Â  Â  Â  Â  .movie-card.flipped {
Â  Â  Â  Â  Â  Â  transform: rotateY(180deg) scale(1.1);
Â  Â  Â  Â  Â  Â  z-index: 10;
Â  Â  Â  Â  Â  Â  position: relative; /* Ensure z-index works correctly */
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  .movie-card-front, .movie-card-back {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  backface-visibility: hidden;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  justify-content: flex-start;
Â  Â  Â  Â  Â  Â  padding: 1.5rem;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
Â  Â  Â  Â  Â  Â  border-radius: 0.75rem;
Â  Â  Â  Â  Â  Â  background-color: #ffffff;
Â  Â  Â  Â  }
Â  Â  Â  Â  .movie-card-back {
Â  Â  Â  Â  Â  Â  transform: rotateY(180deg);
Â  Â  Â  Â  }
Â  Â  Â  Â  /* End of CSS for flip animation */

Â  Â  Â  Â  /* CSS to maintain a 2:3 aspect ratio for movie posters */
Â  Â  Â  Â  .poster-container {
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding-bottom: 150%;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  }
Â  Â  Â  Â  .poster-container img {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  object-fit: cover;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* Added new CSS for the list view layout to ensure it's not a flip card */
Â  Â  Â  Â  .movie-list-item {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 1rem;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  background-color: white;
Â  Â  Â  Â  Â  Â  padding: 1rem;
Â  Â  Â  Â  Â  Â  border-radius: 0.75rem;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  .movie-list-item .poster-container {
Â  Â  Â  Â  Â  Â  width: 80px;
Â  Â  Â  Â  Â  Â  flex-shrink: 0;
Â  Â  Â  Â  }
Â  Â  Â  Â  .movie-list-item .movie-details {
Â  Â  Â  Â  Â  Â  flex-grow: 1;
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body class="p-4 sm:p-8">

Â  Â  <main class="max-w-7xl mx-auto">
Â  Â  Â  Â  <h1 class="text-3xl sm:text-4xl font-bold text-gray-800 mb-6 sm:mb-8 text-center">My Movie Collection</h1>

Â  Â  Â  Â  <div class="flex justify-center items-center mb-6">
Â  Â  Â  Â  Â  Â  <button id="login-btn" class="px-6 py-3 bg-blue-500 text-white font-bold rounded-md shadow hover:bg-blue-600 transition-colors duration-200">
Â  Â  Â  Â  Â  Â  Â  Â  Sign In with Google
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <button id="signout-btn" class="px-6 py-3 bg-red-500 text-white font-bold rounded-md shadow hover:bg-red-600 transition-colors duration-200" style="display: none;">
Â  Â  Â  Â  Â  Â  Â  Â  Sign Out
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="authenticated-content" style="display: none;">
Â  Â  Â  Â  Â  Â  <div class="flex flex-col lg:flex-row justify-between items-center bg-white p-4 sm:p-6 rounded-xl shadow-md mb-6 gap-4">
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex flex-col sm:flex-row gap-4 w-full lg:w-auto">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center space-x-2 w-full sm:w-auto">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="sort-by" class="text-gray-700 font-medium whitespace-nowrap">Sort By:</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="sort-by" class="p-2 border border-gray-300 rounded-md bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 w-full">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="title" selected>Title</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="year">Year</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="rating">Rating</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="length">Length</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="genre">Genre</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="tomatometer">Tomatometer</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="audienceScore">Audience Score</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="imdb">IMDb Score</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center space-x-2 w-full sm:w-auto">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="filter-by-media" class="text-gray-700 font-medium whitespace-nowrap">Filter by Media:</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="filter-by-media" class="p-2 border border-gray-300 rounded-md bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 w-full">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="all">All</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="4K Ultra HD">4K Ultra HD</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Blu-Ray">Blu-Ray</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="DVD">DVD</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center space-x-2 w-full sm:w-auto">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="filter-by-genre" class="text-gray-700 font-medium whitespace-nowrap">Filter by Genre:</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="filter-by-genre" class="p-2 border border-gray-300 rounded-md bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 w-full">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="all">All</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Sci-Fi">Sci-Fi</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Action">Action</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Drama">Drama</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Crime">Crime</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Not Rated">Not Rated</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center space-x-2 w-full sm:w-auto mt-4 sm:mt-0">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-gray-700 font-medium whitespace-nowrap">View:</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button data-view="list" class="view-btn px-3 py-1 bg-gray-200 text-gray-800 font-semibold rounded-md shadow hover:bg-gray-300 transition-colors duration-200">List</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button data-view="grid-3" class="view-btn px-3 py-1 bg-gray-200 text-gray-800 font-semibold rounded-md shadow hover:bg-gray-300 transition-colors duration-200">3</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button data-view="grid-4" class="view-btn px-3 py-1 bg-blue-500 text-white font-semibold rounded-md shadow hover:bg-blue-600 transition-colors duration-200">4</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button data-view="grid-5" class="view-btn px-3 py-1 bg-gray-200 text-gray-800 font-semibold rounded-md shadow hover:bg-gray-300 transition-colors duration-200">5</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex flex-col sm:flex-row gap-2 w-full lg:w-auto mt-4 lg:mt-0">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="search-input" placeholder="Search movies..." class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="sort-order" class="w-full sm:w-auto px-4 py-2 bg-blue-500 text-white font-semibold rounded-md shadow hover:bg-blue-600 transition-colors duration-200">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="sort-order-text">Sort Ascending</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="reset-filters" class="w-full sm:w-auto px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-md shadow hover:bg-gray-300 transition-colors duration-200">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Reset
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  <div id="status-indicator" class="bg-white p-4 rounded-xl shadow-md text-gray-700 text-center mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  Please sign in to view your collection.
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  <div class="flex justify-center mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  <button id="add-movie-btn" class="px-6 py-3 bg-green-500 text-white font-bold rounded-md shadow hover:bg-green-600 transition-colors duration-200">Add New Movie</button>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="movies-container" class="grid gap-6">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </main>

Â  Â  <div id="movie-modal-backdrop" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 transition-opacity duration-300 opacity-0 pointer-events-none">
Â  Â  Â  Â  <div id="movie-modal" class="bg-white p-6 rounded-xl shadow-2xl w-full max-w-md transform scale-95 transition-all duration-300">
Â  Â  Â  Â  Â  Â  <h2 id="modal-title" class="text-2xl font-bold text-gray-800 mb-4">Add New Movie</h2>
Â  Â  Â  Â  Â  Â  <form id="movie-form" class="space-y-4">
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="movie-title" class="block text-sm font-medium text-gray-700">Title</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="movie-title" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" required>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="movie-year" class="block text-sm font-medium text-gray-700">Year</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="movie-year" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" required>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="movie-rating" class="block text-sm font-medium text-gray-700">Rating</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="movie-rating" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="G">G</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="PG">PG</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="PG-13">PG-13</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="R">R</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="NC-17">NC-17</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Not Rated">Not Rated</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="movie-length" class="block text-sm font-medium text-gray-700">Length (minutes)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="movie-length" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="movie-genre" class="block text-sm font-medium text-gray-700">Genre</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="movie-genre" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="movie-tomatometer" class="block text-sm font-medium text-gray-700">Tomatometer (%)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="movie-tomatometer" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" min="0" max="100">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="movie-audience-score" class="block text-sm font-medium text-gray-700">Audience Score (%)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="movie-audience-score" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" min="0" max="100">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="movie-imdb" class="block text-sm font-medium text-gray-700">IMDb Score (/10)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="movie-imdb" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" step="0.1" min="0" max="10">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="movie-media" class="block text-sm font-medium text-gray-700">Media Type</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="movie-media" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="4K Ultra HD">4K Ultra HD</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Blu-Ray">Blu-Ray</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="DVD">DVD</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="movie-image-url" class="block text-sm font-medium text-gray-700">Image URL (Optional)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="url" id="movie-image-url" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-center mt-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" id="delete-movie-btn" class="px-4 py-2 bg-red-500 text-white font-semibold rounded-md shadow hover:bg-red-600 transition-colors duration-200" style="display: none;">Delete Movie</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex space-x-2 ml-auto">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" id="cancel-modal-btn" class="px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-md shadow hover:bg-gray-300 transition-colors duration-200">Cancel</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" id="save-movie-btn" class="px-4 py-2 bg-blue-500 text-white font-semibold rounded-md shadow hover:bg-blue-600 transition-colors duration-200">Add Movie</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script type="module">
Â  Â  Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
Â  Â  Â  Â  import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
Â  Â  Â  Â  import { getFirestore, collection, onSnapshot, doc, addDoc, setDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

Â  Â  Â  Â  // IMPORTANT: For local development, hardcode your Firebase config.
Â  Â  Â  Â  // Replace this with your actual configuration.
Â  Â  Â  Â  const firebaseConfig = {
Â  Â  Â  Â  Â  Â  apiKey: "AIzaSyBf9ZHgLHkIIIH9-C9etHGMf8xTno2K9u8",
Â  Â  Â  Â  Â  Â  authDomain: "my-movie-collection-1ed74.firebaseapp.com",
Â  Â  Â  Â  Â  Â  projectId: "my-movie-collection-1ed74",
Â  Â  Â  Â  Â  Â  storageBucket: "my-movie-collection-1ed74.firebasestorage.app",
Â  Â  Â  Â  Â  Â  messagingSenderId: "513133972702",
Â  Â  Â  Â  Â  Â  appId: "1:513133972702:web:f0d4cfbb018f9e815a864f",
Â  Â  Â  Â  Â  Â  measurementId: "G-S41SMHF1WD"
Â  Â  Â  Â  };
Â  Â  Â  Â  
Â  Â  Â  Â  const app = initializeApp(firebaseConfig);
Â  Â  Â  Â  const db = getFirestore(app);
Â  Â  Â  Â  const auth = getAuth(app);
Â  Â  Â  Â  
Â  Â  Â  Â  let moviesCollectionRef;
Â  Â  Â  Â  let allMovies = [];
Â  Â  Â  Â  let isAscending = true;
Â  Â  Â  Â  let isManualViewSelected = false;
Â  Â  Â  Â  let currentEditingMovieId = null;
Â  Â  Â  Â  
Â  Â  Â  Â  const defaultMoviesData = `[
Â  Â  Â  Â  Â  Â  { "title": "10 Cloverfield Lane", "year": 2016, "tomatometer": 91, "audienceScore": 79, "imdb": 7.2, "media": "4K Ultra HD", "rating": "PG-13", "length": 103, "genre": "Sci-Fi", "imageUrl": "https://placehold.co/300x450/e0e0e0/555555?text=10+Cloverfield+Lane" },
Â  Â  Â  Â  Â  Â  { "title": "American Sniper", "year": 2014, "tomatometer": 34, "audienceScore": 85, "imdb": 7.3, "media": "4K Ultra HD", "rating": "R", "length": 133, "genre": "Action", "imageUrl": "https://placehold.co/300x450/e0e0e0/555555?text=American+Sniper" },
Â  Â  Â  Â  Â  Â  { "title": "Back to the Future", "year": 1985, "tomatometer": 93, "audienceScore": 95, "imdb": 8.5, "media": "4K Ultra HD", "rating": "PG", "length": 116, "genre": "Sci-Fi", "imageUrl": "https://placehold.co/300x450/e0e0e0/555555?text=Back+to+the+Future" },
Â  Â  Â  Â  Â  Â  { "title": "Batman Begins", "year": 2005, "tomatometer": 84, "audienceScore": 89, "imdb": 8.2, "media": "4K Ultra HD", "rating": "PG-13", "length": 140, "genre": "Action", "imageUrl": "https://placehold.co/300x450/e0e0e0/555555?text=Batman+Begins" },
Â  Â  Â  Â  Â  Â  { "title": "Dune (2021)", "year": 2021, "tomatometer": 83, "audienceScore": 90, "imdb": 8.0, "media": "4K Ultra HD", "rating": "PG-13", "length": 155, "genre": "Sci-Fi", "imageUrl": "https://placehold.co/300x450/e0e0e0/555555?text=Dune" },
Â  Â  Â  Â  Â  Â  { "title": "Gladiator", "year": 2000, "tomatometer": 76, "audienceScore": 86, "imdb": 8.5, "media": "DVD", "rating": "R", "length": 155, "genre": "Action", "imageUrl": "https://placehold.co/300x450/e0e0e0/555555?text=Gladiator" },
Â  Â  Â  Â  Â  Â  { "title": "The Departed", "year": 2006, "tomatometer": 91, "audienceScore": 94, "imdb": 8.5, "media": "Blu-Ray", "rating": "R", "length": 151, "genre": "Crime", "imageUrl": "https://placehold.co/300x450/e0e0e0/555555?text=The+Departed" },
Â  Â  Â  Â  Â  Â  { "title": "The Shawshank Redemption", "year": 1994, "tomatometer": 91, "audienceScore": 96, "imdb": 9.3, "media": "4K Ultra HD", "rating": "R", "length": 142, "genre": "Drama", "imageUrl": "https://placehold.co/300x450/e0e0e0/555555?text=The+Shawshank+Redemption" },
Â  Â  Â  Â  Â  Â  { "title": "The Dark Knight", "year": 2008, "tomatometer": 94, "audienceScore": 94, "imdb": 9.0, "media": "4K Ultra HD", "rating": "PG-13", "length": 152, "genre": "Action", "imageUrl": "https://placehold.co/300x450/e0e0e0/555555?text=The+Dark+Knight" },
Â  Â  Â  Â  Â  Â  { "title": "Pulp Fiction", "year": 1994, "tomatometer": 92, "audienceScore": 96, "imdb": 8.9, "media": "Blu-Ray", "rating": "R", "length": 154, "genre": "Crime", "imageUrl": "https://placehold.co/300x450/e0e0e0/555555?text=Pulp+Fiction" }
Â  Â  Â  Â  ]`;
Â  Â  Â  Â  
Â  Â  Â  Â  function createMovieCard(movie) {
Â  Â  Â  Â  Â  Â  const isListView = document.getElementById('movies-container').classList.contains('flex');
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const container = document.createElement('div');
Â  Â  Â  Â  Â  Â  container.setAttribute('data-movie-id', movie.id);

Â  Â  Â  Â  Â  Â  // If list view, create a simpler card
Â  Â  Â  Â  Â  Â  if (isListView) {
Â  Â  Â  Â  Â  Â  Â  Â  container.classList.add('movie-list-item');
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  const imageContainer = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  imageContainer.classList.add('poster-container', 'rounded-md');
Â  Â  Â  Â  Â  Â  Â  Â  const movieImage = document.createElement('img');
Â  Â  Â  Â  Â  Â  Â  Â  movieImage.src = movie.imageUrl || `https://placehold.co/300x450/e0e0e0/555555?text=${movie.title.replace(/ /g, '+')}`;
Â  Â  Â  Â  Â  Â  Â  Â  movieImage.alt = `Poster for ${movie.title}`;
Â  Â  Â  Â  Â  Â  Â  Â  imageContainer.appendChild(movieImage);
Â  Â  Â  Â  Â  Â  Â  Â  container.appendChild(imageContainer);
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  const detailsDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  detailsDiv.classList.add('movie-details', 'space-y-1');
Â  Â  Â  Â  Â  Â  Â  Â  detailsDiv.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2 class="text-xl font-bold text-gray-900">${movie.title} (${movie.year})</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-gray-700"><strong>Genre:</strong> ${movie.genre || 'N/A'}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-gray-700"><strong>Rating:</strong> ${movie.rating || 'N/A'}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-gray-700"><strong>Length:</strong> ${movie.length ? `${movie.length} min` : 'N/A'}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-gray-700"><strong>Media:</strong> ${movie.media}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-gray-700">ğŸ… Tomatometer: ${movie.tomatometer}% | ğŸ¿ Audience: ${movie.audienceScore}% | â­ IMDb: ${movie.imdb}/10</p>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  container.appendChild(detailsDiv);
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  const editButton = document.createElement('button');
Â  Â  Â  Â  Â  Â  Â  Â  editButton.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500 hover:text-blue-500 transition-colors" viewBox="0 0 20 20" fill="currentColor">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zm-4.757 1.586l-2.828 2.828-6.172 6.172a2 2 0 00-.586 1.414V17a1 1 0 001 1h4.172a2 2 0 001.414-.586l6.172-6.172-2.828-2.828-6.172 6.172z" />
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  editButton.addEventListener('click', (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.stopPropagation();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  openModalForEdit(movie.id);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  container.appendChild(editButton);
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  return container;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // Original flip card logic for grid views
Â  Â  Â  Â  Â  Â  Â  Â  container.classList.add('movie-card-container', 'w-full', 'h-full', 'cursor-pointer');

Â  Â  Â  Â  Â  Â  Â  Â  const card = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  card.classList.add('movie-card');
Â  Â  Â  Â  Â  Â  Â  Â  card.setAttribute('data-movie-id', movie.id);

Â  Â  Â  Â  Â  Â  Â  Â  // Front of the card (Original Design)
Â  Â  Â  Â  Â  Â  Â  Â  const cardFront = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  cardFront.classList.add('movie-card-front', 'bg-white', 'p-6', 'rounded-xl', 'shadow-md', 'hover:shadow-lg', 'transition-shadow', 'duration-300', 'flex', 'flex-col', 'space-y-2', 'relative');
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  const editButton = document.createElement('button');
Â  Â  Â  Â  Â  Â  Â  Â  editButton.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500 hover:text-blue-500 transition-colors" viewBox="0 0 20 20" fill="currentColor">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zm-4.757 1.586l-2.828 2.828-6.172 6.172a2 2 0 00-.586 1.414V17a1 1 0 001 1h4.172a2 2 0 001.414-.586l6.172-6.172-2.828-2.828-6.172 6.172z" />
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  editButton.classList.add('absolute', 'top-4', 'right-4', 'p-1', 'rounded-full', 'bg-white', 'hover:bg-gray-100', 'transition-colors', 'duration-200');
Â  Â  Â  Â  Â  Â  Â  Â  editButton.addEventListener('click', (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  e.stopPropagation();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  openModalForEdit(movie.id);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  cardFront.appendChild(editButton);

Â  Â  Â  Â  Â  Â  Â  Â  const imageContainer = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  imageContainer.classList.add('poster-container', 'rounded-md', 'mb-2');
Â  Â  Â  Â  Â  Â  Â  Â  const movieImage = document.createElement('img');
Â  Â  Â  Â  Â  Â  Â  Â  movieImage.src = movie.imageUrl || `https://placehold.co/300x450/e0e0e0/555555?text=${movie.title.replace(/ /g, '+')}`;
Â  Â  Â  Â  Â  Â  Â  Â  movieImage.alt = `Poster for ${movie.title}`;
Â  Â  Â  Â  Â  Â  Â  Â  imageContainer.appendChild(movieImage);
Â  Â  Â  Â  Â  Â  Â  Â  cardFront.appendChild(imageContainer);

Â  Â  Â  Â  Â  Â  Â  Â  const titleHeading = document.createElement('h2');
Â  Â  Â  Â  Â  Â  Â  Â  titleHeading.classList.add('text-lg', 'font-semibold', 'text-gray-900');
Â  Â  Â  Â  Â  Â  Â  Â  titleHeading.textContent = `${movie.title} (${movie.year})`;
Â  Â  Â  Â  Â  Â  Â  Â  cardFront.appendChild(titleHeading);

Â  Â  Â  Â  Â  Â  Â  Â  const scoresDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  scoresDiv.classList.add('flex', 'flex-wrap', 'gap-4', 'text-sm', 'text-gray-600');
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  const tomatometerSpan = document.createElement('span');
Â  Â  Â  Â  Â  Â  Â  Â  tomatometerSpan.textContent = `ğŸ… Tomatometer: ${movie.tomatometer}%`;
Â  Â  Â  Â  Â  Â  Â  Â  scoresDiv.appendChild(tomatometerSpan);

Â  Â  Â  Â  Â  Â  Â  Â  const audienceScoreSpan = document.createElement('span');
Â  Â  Â  Â  Â  Â  Â  Â  audienceScoreSpan.textContent = `ğŸ¿ Audience: ${movie.audienceScore}%`;
Â  Â  Â  Â  Â  Â  Â  Â  scoresDiv.appendChild(audienceScoreSpan);

Â  Â  Â  Â  Â  Â  Â  Â  const imdbSpan = document.createElement('span');
Â  Â  Â  Â  Â  Â  Â  Â  imdbSpan.textContent = `â­ IMDb: ${movie.imdb}/10`;
Â  Â  Â  Â  Â  Â  Â  Â  scoresDiv.appendChild(imdbSpan);
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  cardFront.appendChild(scoresDiv);

Â  Â  Â  Â  Â  Â  Â  Â  const mediaDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  mediaDiv.classList.add('mt-auto', 'text-xs', 'font-medium', 'text-gray-500');
Â  Â  Â  Â  Â  Â  Â  Â  mediaDiv.textContent = `Media: ${movie.media}`;
Â  Â  Â  Â  Â  Â  Â  Â  cardFront.appendChild(mediaDiv);


Â  Â  Â  Â  Â  Â  Â  Â  // Back of the card (Organized Details)
Â  Â  Â  Â  Â  Â  Â  Â  const cardBack = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  cardBack.classList.add('movie-card-back', 'bg-white', 'p-6', 'rounded-xl', 'shadow-md', 'hover:shadow-lg', 'transition-shadow', 'duration-300', 'flex', 'flex-col', 'space-y-4');
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  const backHeader = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  backHeader.classList.add('flex', 'justify-between', 'items-start', 'gap-4');
Â  Â  Â  Â  Â  Â  Â  Â  const backTitle = document.createElement('h2');
Â  Â  Â  Â  Â  Â  Â  Â  backTitle.classList.add('text-xl', 'font-bold', 'text-gray-900');
Â  Â  Â  Â  Â  Â  Â  Â  backTitle.textContent = movie.title;
Â  Â  Â  Â  Â  Â  Â  Â  const backYear = document.createElement('span');
Â  Â  Â  Â  Â  Â  Â  Â  backYear.classList.add('text-lg', 'font-medium', 'text-gray-500');
Â  Â  Â  Â  Â  Â  Â  Â  backYear.textContent = `(${movie.year})`;
Â  Â  Â  Â  Â  Â  Â  Â  backHeader.appendChild(backTitle);
Â  Â  Â  Â  Â  Â  Â  Â  backHeader.appendChild(backYear);
Â  Â  Â  Â  Â  Â  Â  Â  cardBack.appendChild(backHeader);

Â  Â  Â  Â  Â  Â  Â  Â  const detailsList = document.createElement('ul');
Â  Â  Â  Â  Â  Â  Â  Â  detailsList.classList.add('text-sm', 'text-gray-700', 'space-y-1');
Â  Â  Â  Â  Â  Â  Â  Â  detailsList.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>Rating:</strong> ${movie.rating || 'N/A'}</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>Length:</strong> ${movie.length ? `${movie.length} min` : 'N/A'}</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>Genre:</strong> ${movie.genre || 'N/A'}</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>Media:</strong> ${movie.media}</li>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  cardBack.appendChild(detailsList);
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  const scoresList = document.createElement('ul');
Â  Â  Â  Â  Â  Â  Â  Â  scoresList.classList.add('text-sm', 'text-gray-700', 'space-y-1');
Â  Â  Â  Â  Â  Â  Â  Â  scoresList.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>ğŸ… <strong>Tomatometer:</strong> ${movie.tomatometer}%</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>ğŸ¿ <strong>Audience:</strong> ${movie.audienceScore}%</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>â­ <strong>IMDb:</strong> ${movie.imdb}/10</li>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  cardBack.appendChild(scoresList);

Â  Â  Â  Â  Â  Â  Â  Â  card.appendChild(cardFront);
Â  Â  Â  Â  Â  Â  Â  Â  card.appendChild(cardBack);
Â  Â  Â  Â  Â  Â  Â  Â  container.appendChild(card);
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  card.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  card.classList.toggle('flipped');
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  return container;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  function updateStatusIndicator(movies) {
Â  Â  Â  Â  Â  Â  const indicator = document.getElementById('status-indicator');
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  if (!movies || movies.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  indicator.innerHTML = `No movies found. Add your first movie!`;
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const counts = movies.reduce((acc, movie) => {
Â  Â  Â  Â  Â  Â  Â  Â  acc[movie.media] = (acc[movie.media] || 0) + 1;
Â  Â  Â  Â  Â  Â  Â  Â  return acc;
Â  Â  Â  Â  Â  Â  }, {});
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const total = movies.length;
Â  Â  Â  Â  Â  Â  let html = `<span>Total Movies: <strong>${total}</strong></span>`;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  for (const mediaType in counts) {
Â  Â  Â  Â  Â  Â  Â  Â  html += ` | <span>${mediaType}: <strong>${counts[mediaType]}</strong></span>`;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  indicator.innerHTML = html;
Â  Â  Â  Â  }

Â  Â  Â  Â  function filterAndSortMovies() {
Â  Â  Â  Â  Â  Â  const sortBy = document.getElementById('sort-by').value;
Â  Â  Â  Â  Â  Â  const filterByMedia = document.getElementById('filter-by-media').value;
Â  Â  Â  Â  Â  Â  const filterByGenre = document.getElementById('filter-by-genre').value;
Â  Â  Â  Â  Â  Â  const moviesContainer = document.getElementById('movies-container');
Â  Â  Â  Â  Â  Â  const searchQuery = document.getElementById('search-input').value.toLowerCase();

Â  Â  Â  Â  Â  Â  let filteredMovies = allMovies;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  if (filterByMedia !== 'all') {
Â  Â  Â  Â  Â  Â  Â  Â  filteredMovies = filteredMovies.filter(movie => movie.media === filterByMedia);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  if (filterByGenre !== 'all') {
Â  Â  Â  Â  Â  Â  Â  Â  filteredMovies = filteredMovies.filter(movie => movie.genre === filterByGenre);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  if (searchQuery) {
Â  Â  Â  Â  Â  Â  Â  Â  filteredMovies = filteredMovies.filter(movie => movie.title.toLowerCase().includes(searchQuery));
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  filteredMovies.sort((a, b) => {
Â  Â  Â  Â  Â  Â  Â  Â  let aValue, bValue;
Â  Â  Â  Â  Â  Â  Â  Â  if (sortBy === 'title' || sortBy === 'rating' || sortBy === 'genre') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  aValue = a[sortBy];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  bValue = b[sortBy];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Handle missing values and localeCompare for strings
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  aValue = aValue ? aValue.toLowerCase() : '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  bValue = bValue ? bValue.toLowerCase() : '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return isAscending ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);
Â  Â  Â  Â  Â  Â  Â  Â  } else { // Numbers: year, length, scores
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  aValue = a[sortBy] || 0;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  bValue = b[sortBy] || 0;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  if (aValue < bValue) return isAscending ? -1 : 1;
Â  Â  Â  Â  Â  Â  Â  Â  if (aValue > bValue) return isAscending ? 1 : -1;
Â  Â  Â  Â  Â  Â  Â  Â  return 0;
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  moviesContainer.innerHTML = '';
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  filteredMovies.forEach((movie) => {
Â  Â  Â  Â  Â  Â  Â  Â  const movieCard = createMovieCard(movie);
Â  Â  Â  Â  Â  Â  Â  Â  moviesContainer.appendChild(movieCard);
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  updateStatusIndicator(filteredMovies);
Â  Â  Â  Â  }

Â  Â  Â  Â  function setView(view) {
Â  Â  Â  Â  Â  Â  const moviesContainer = document.getElementById('movies-container');
Â  Â  Â  Â  Â  Â  isManualViewSelected = true;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // Clear existing classes
Â  Â  Â  Â  Â  Â  moviesContainer.classList.remove('grid', 'flex', 'grid-cols-1', 'grid-cols-2', 'grid-cols-3', 'grid-cols-4', 'grid-cols-5', 'flex-col');
Â  Â  Â  Â  Â  Â  moviesContainer.classList.add('gap-6'); // Add default gap back

Â  Â  Â  Â  Â  Â  if (view === 'list') {
Â  Â  Â  Â  Â  Â  Â  Â  moviesContainer.classList.add('flex', 'flex-col');
Â  Â  Â  Â  Â  Â  } else if (view === 'grid-3') {
Â  Â  Â  Â  Â  Â  Â  Â  moviesContainer.classList.add('grid', 'grid-cols-3');
Â  Â  Â  Â  Â  Â  } else if (view === 'grid-4') {
Â  Â  Â  Â  Â  Â  Â  Â  moviesContainer.classList.add('grid', 'grid-cols-4');
Â  Â  Â  Â  Â  Â  } else if (view === 'grid-5') {
Â  Â  Â  Â  Â  Â  Â  Â  moviesContainer.classList.add('grid', 'grid-cols-5');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  function openModalForAdd() {
Â  Â  Â  Â  Â  Â  currentEditingMovieId = null;
Â  Â  Â  Â  Â  Â  const form = document.getElementById('movie-form');
Â  Â  Â  Â  Â  Â  form.reset();
Â  Â  Â  Â  Â  Â  document.getElementById('modal-title').textContent = 'Add New Movie';
Â  Â  Â  Â  Â  Â  document.getElementById('save-movie-btn').textContent = 'Add Movie';
Â  Â  Â  Â  Â  Â  document.getElementById('delete-movie-btn').style.display = 'none';

Â  Â  Â  Â  Â  Â  document.getElementById('movie-modal-backdrop').classList.replace('opacity-0', 'opacity-100');
Â  Â  Â  Â  Â  Â  document.getElementById('movie-modal-backdrop').classList.replace('pointer-events-none', 'pointer-events-auto');
Â  Â  Â  Â  Â  Â  document.getElementById('movie-modal').classList.replace('scale-95', 'scale-100');
Â  Â  Â  Â  }

Â  Â  Â  Â  function openModalForEdit(movieId) {
Â  Â  Â  Â  Â  Â  currentEditingMovieId = movieId;
Â  Â  Â  Â  Â  Â  const movie = allMovies.find(m => m.id === movieId);
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  document.getElementById('modal-title').textContent = 'Edit Movie';
Â  Â  Â  Â  Â  Â  document.getElementById('save-movie-btn').textContent = 'Save Changes';
Â  Â  Â  Â  Â  Â  document.getElementById('delete-movie-btn').style.display = 'block';

Â  Â  Â  Â  Â  Â  document.getElementById('movie-title').value = movie.title;
Â  Â  Â  Â  Â  Â  document.getElementById('movie-year').value = movie.year;
Â  Â  Â  Â  Â  Â  document.getElementById('movie-rating').value = movie.rating;
Â  Â  Â  Â  Â  Â  document.getElementById('movie-length').value = movie.length;
Â  Â  Â  Â  Â  Â  document.getElementById('movie-genre').value = movie.genre;
Â  Â  Â  Â  Â  Â  document.getElementById('movie-tomatometer').value = movie.tomatometer;
Â  Â  Â  Â  Â  Â  document.getElementById('movie-audience-score').value = movie.audienceScore;
Â  Â  Â  Â  Â  Â  document.getElementById('movie-imdb').value = movie.imdb;
Â  Â  Â  Â  Â  Â  document.getElementById('movie-media').value = movie.media;
Â  Â  Â  Â  Â  Â  document.getElementById('movie-image-url').value = movie.imageUrl || '';
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  document.getElementById('delete-movie-btn').onclick = () => {
Â  Â  Â  Â  Â  Â  Â  Â  if (confirm("Are you sure you want to delete this movie?")) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deleteMovie(movieId);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  closeModal();
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  document.getElementById('movie-modal-backdrop').classList.replace('opacity-0', 'opacity-100');
Â  Â  Â  Â  Â  Â  document.getElementById('movie-modal-backdrop').classList.replace('pointer-events-none', 'pointer-events-auto');
Â  Â  Â  Â  Â  Â  document.getElementById('movie-modal').classList.replace('scale-95', 'scale-100');
Â  Â  Â  Â  }

Â  Â  Â  Â  function closeModal() {
Â  Â  Â  Â  Â  Â  document.getElementById('movie-modal-backdrop').classList.replace('opacity-100', 'opacity-0');
Â  Â  Â  Â  Â  Â  document.getElementById('movie-modal-backdrop').classList.replace('pointer-events-auto', 'pointer-events-none');
Â  Â  Â  Â  Â  Â  document.getElementById('movie-modal').classList.replace('scale-100', 'scale-95');
Â  Â  Â  Â  Â  Â  document.getElementById('movie-form').reset();
Â  Â  Â  Â  }

Â  Â  Â  Â  async function handleFormSubmit(event) {
Â  Â  Â  Â  Â  Â  event.preventDefault();
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const title = document.getElementById('movie-title').value;
Â  Â  Â  Â  Â  Â  const year = parseInt(document.getElementById('movie-year').value);
Â  Â  Â  Â  Â  Â  const rating = document.getElementById('movie-rating').value;
Â  Â  Â  Â  Â  Â  const length = parseInt(document.getElementById('movie-length').value) || null;
Â  Â  Â  Â  Â  Â  const genre = document.getElementById('movie-genre').value || null;
Â  Â  Â  Â  Â  Â  const tomatometer = parseInt(document.getElementById('movie-tomatometer').value) || 0;
Â  Â  Â  Â  Â  Â  const audienceScore = parseInt(document.getElementById('movie-audience-score').value) || 0;
Â  Â  Â  Â  Â  Â  const imdb = parseFloat(document.getElementById('movie-imdb').value) || 0;
Â  Â  Â  Â  Â  Â  const media = document.getElementById('movie-media').value;
Â  Â  Â  Â  Â  Â  const imageUrl = document.getElementById('movie-image-url').value || null;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const newOrUpdatedMovie = { title, year, rating, length, genre, tomatometer, audienceScore, imdb, media, imageUrl };
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  if (currentEditingMovieId) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await setDoc(doc(moviesCollectionRef, currentEditingMovieId), newOrUpdatedMovie);
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await addDoc(moviesCollectionRef, newOrUpdatedMovie);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error adding/updating document: ", e);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  closeModal();
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  async function deleteMovie(movieId) {
Â  Â  Â  Â  Â  Â  if (confirm("Are you sure you want to delete this movie?")) {
Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await deleteDoc(doc(moviesCollectionRef, movieId));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("Document successfully deleted!");
Â  Â  Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error removing document: ", e);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function signInWithGoogle() {
Â  Â  Â  Â  Â  Â  const provider = new GoogleAuthProvider();
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  await signInWithPopup(auth, provider);
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error during Google Sign-In:", error);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function handleSignOut() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  await signOut(auth);
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error during Sign-Out:", error);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function init() {
Â  Â  Â  Â  Â  Â  onAuthStateChanged(auth, async (user) => {
Â  Â  Â  Â  Â  Â  Â  Â  const loginButton = document.getElementById('login-btn');
Â  Â  Â  Â  Â  Â  Â  Â  const signOutButton = document.getElementById('signout-btn');
Â  Â  Â  Â  Â  Â  Â  Â  const authenticatedContent = document.getElementById('authenticated-content');
Â  Â  Â  Â  Â  Â  Â  Â  const statusIndicator = document.getElementById('status-indicator');

Â  Â  Â  Â  Â  Â  Â  Â  if (user) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("User is authenticated:", user.uid);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  loginButton.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  signOutButton.style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  authenticatedContent.style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  moviesCollectionRef = collection(db, `users/${user.uid}/movies`);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  onSnapshot(moviesCollectionRef, (snapshot) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const moviesFromDb = [];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  snapshot.forEach(doc => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  moviesFromDb.push({ id: doc.id, ...doc.data() });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  allMovies = moviesFromDb;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  filterAndSortMovies();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log("No user is authenticated.");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  loginButton.style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  signOutButton.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  authenticatedContent.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusIndicator.innerHTML = 'Please sign in to view your collection.';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  allMovies = [];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  filterAndSortMovies();
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  Â  Â  Â  document.getElementById('add-movie-btn').addEventListener('click', openModalForAdd);
Â  Â  Â  Â  Â  Â  document.getElementById('cancel-modal-btn').addEventListener('click', closeModal);
Â  Â  Â  Â  Â  Â  document.getElementById('movie-form').addEventListener('submit', handleFormSubmit);

Â  Â  Â  Â  Â  Â  document.getElementById('login-btn').addEventListener('click', signInWithGoogle);
Â  Â  Â  Â  Â  Â  document.getElementById('signout-btn').addEventListener('click', handleSignOut);

Â  Â  Â  Â  Â  Â  document.querySelectorAll('.view-btn').forEach(button => {
Â  Â  Â  Â  Â  Â  Â  Â  button.addEventListener('click', (event) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.querySelectorAll('.view-btn').forEach(btn => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.remove('bg-blue-500', 'text-white');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.add('bg-gray-200', 'text-gray-800');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  event.target.classList.remove('bg-gray-200', 'text-gray-800');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  event.target.classList.add('bg-blue-500', 'text-white');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const viewType = event.target.dataset.view;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setView(viewType);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  filterAndSortMovies(); // Re-render the movies with the new view
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  document.getElementById('sort-by').addEventListener('change', filterAndSortMovies);
Â  Â  Â  Â  Â  Â  document.getElementById('filter-by-media').addEventListener('change', filterAndSortMovies);
Â  Â  Â  Â  Â  Â  document.getElementById('filter-by-genre').addEventListener('change', filterAndSortMovies);
Â  Â  Â  Â  Â  Â  document.getElementById('sort-order').addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  Â  Â  isAscending = !isAscending;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('sort-order-text').textContent = isAscending ? 'Sort Ascending' : 'Sort Descending';
Â  Â  Â  Â  Â  Â  Â  Â  filterAndSortMovies();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  document.getElementById('reset-filters').addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('sort-by').value = 'title';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('filter-by-media').value = 'all';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('filter-by-genre').value = 'all';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('search-input').value = '';

Â  Â  Â  Â  Â  Â  Â  Â  isAscending = true; 
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('sort-order-text').textContent = 'Sort Ascending';

Â  Â  Â  Â  Â  Â  Â  Â  setView('grid-4');
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelectorAll('.view-btn').forEach(btn => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.remove('bg-blue-500', 'text-white');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.classList.add('bg-gray-200', 'text-gray-800');
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelector('[data-view="grid-4"]').classList.remove('bg-gray-200', 'text-gray-800');
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelector('[data-view="grid-4"]').classList.add('bg-blue-500', 'text-white');

Â  Â  Â  Â  Â  Â  Â  Â  filterAndSortMovies();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  document.getElementById('search-input').addEventListener('keyup', filterAndSortMovies);
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  setView('grid-4');

Â  Â  Â  Â  Â  Â  init();
Â  Â  Â  Â  });
Â  Â  </script>
</body>
</html>
